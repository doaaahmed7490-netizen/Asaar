"use strict";(self.webpackChunknebular_downgrade_2=self.webpackChunknebular_downgrade_2||[]).push([[561],{7561:(st,y,h)=>{h.r(y),h.d(y,{RoleModule:()=>it});var C=h(177),p=h(9417),c=h(4069),d=h(7037),m=h(3955),N=h(1322),G=h(1626),_=h(9615),P=h(9213),u=h(2042),$=h(3922),g=h(5743),v=h(5312);class f{}class R{}var b=h(6952),F=h(6962),e=h(7705),k=h(2741),w=h(4866),E=h(8203);const x=["nameFilter"];function M(s,a){1&s&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"roleName is Required")," "))}function L(s,a){1&s&&(e.j41(0,"th",23),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Permissions")," "))}function B(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",27,28),e.bIt("keyup",function(n){e.eBV(i);const r=e.XpG(2);return e.Njj(r.applyFilter(n))}),e.k0s()()}}function j(s,a){if(1&s&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&s){const i=e.XpG().$implicit;e.R7$(1),e.JRh(i.name)}}function A(s,a){if(1&s&&(e.j41(0,"td",24),e.DNE(1,B,3,0,"span",25),e.DNE(2,j,2,1,"ng-template",null,26,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==i.name)("ngIfElse",t)}}function U(s,a){1&s&&(e.j41(0,"th",29),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI("",e.bMT(2,1,"ListAndSearch")," "))}function O(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",30),e.bIt("change",function(n){e.eBV(i);const r=e.XpG().$implicit,o=e.XpG();return e.Njj(o.check(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG().$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid(i.id))}}function X(s,a){if(1&s&&(e.j41(0,"td",24),e.DNE(1,O,2,1,"span",6),e.k0s()),2&s){const i=a.$implicit;e.R7$(1),e.Y8G("ngIf",""!=i.name)}}function V(s,a){1&s&&(e.j41(0,"th",29),e.EFF(1," \u0627\u0644\u0627\u0636\u0627\u0641\u0629"),e.k0s())}function Y(s,a){1&s&&e.nrm(0,"span")}function z(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",30),e.bIt("change",function(n){e.eBV(i);const r=e.XpG(2).$implicit,o=e.XpG();return e.Njj(o.check1(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid1(i.id))}}function W(s,a){if(1&s&&e.DNE(0,z,2,1,"span",6),2&s){const i=e.XpG().$implicit;e.Y8G("ngIf",""!=i.name)}}function H(s,a){if(1&s&&(e.j41(0,"td",24),e.DNE(1,Y,1,0,"span",25),e.DNE(2,W,1,1,"ng-template",null,26,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",1==i.viewActionOnly)("ngIfElse",t)}}function J(s,a){1&s&&(e.j41(0,"th",29),e.EFF(1," \u0627\u0644\u062a\u0639\u062f\u064a\u0644"),e.k0s())}function Z(s,a){1&s&&e.nrm(0,"span")}function q(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",30),e.bIt("change",function(n){e.eBV(i);const r=e.XpG(2).$implicit,o=e.XpG();return e.Njj(o.check2(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid2(i.id))}}function Q(s,a){if(1&s&&e.DNE(0,q,2,1,"span",6),2&s){const i=e.XpG().$implicit;e.Y8G("ngIf",""!=i.name)}}function K(s,a){if(1&s&&(e.j41(0,"td",24),e.DNE(1,Z,1,0,"span",25),e.DNE(2,Q,1,1,"ng-template",null,26,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",1==i.viewActionOnly)("ngIfElse",t)}}function ee(s,a){1&s&&(e.j41(0,"th",29),e.EFF(1," \u0627\u0644\u062d\u0630\u0641"),e.k0s())}function te(s,a){1&s&&e.nrm(0,"span")}function ie(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",30),e.bIt("change",function(n){e.eBV(i);const r=e.XpG(2).$implicit,o=e.XpG();return e.Njj(o.check3(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid3(i.id))}}function se(s,a){if(1&s&&e.DNE(0,ie,2,1,"span",6),2&s){const i=e.XpG().$implicit;e.Y8G("ngIf",""!=i.name)}}function ne(s,a){if(1&s&&(e.j41(0,"td",24),e.DNE(1,te,1,0,"span",25),e.DNE(2,se,1,1,"ng-template",null,26,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",1==i.viewActionOnly)("ngIfElse",t)}}function re(s,a){1&s&&e.nrm(0,"tr",31)}function oe(s,a){1&s&&e.nrm(0,"tr",32)}let le=(()=>{class s{constructor(i,t,n,r,o,l,I,D){this.formBuilder=i,this.router=t,this.route=n,this.toastrService=r,this.translate=o,this._detector=l,this.dialogService=I,this.role=D,this.dir="ltr",this.totalRecords=0,this.pageSizeOptions=v.c.DEFAULT_PAGE_SIZE_OPTIONS,this.submitted=!1,this.isSubmitted=!1,this.privilages=[],this.isLoading=!1,this.EverId=[],this.AttachmentsssId=[],this.index=0,this.privilageID=[],this.OwnersName=[],this.test=!0,this.TypeOfGrant=0,this.displayedColumns=["Name","ischecked","CanAdd","CanUpdate","CanDelete"],this.privilagesFilteredLst=[],this.checkedrows=[],this.privilageRole=[],(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth")}ngOnInit(){this.searchModel={PageNumber:1,PageSize:v.c.DEFAULT_PAGE_SIZE},this.search(),this.initForm()}GetPrivilages(){this.role.ListAllPrivlages({PageNumber:1,PageSize:1e3}).subscribe(i=>{this.privilages=i.entity.entities})}search(i){i?(this.searchModel.PageNumber=i.pageIndex+1,this.searchModel.PageSize=i.pageSize):(this.searchModel.PageNumber=1,this.searchModel.PageSize=10),this.role.ListAllPrivlages(this.searchModel).subscribe(t=>{this.privilages=t.entity.entities,this.totalRecords=t.entity.totalRecords,this.dataSource=new c.I6(this.privilages),this._detector.markForCheck()})}initForm(){this.roleForm=this.formBuilder.group({roleName:["",[p.k0.required]],privilage:this.formBuilder.array([])})}CustomSearchFn(i,t){return t.name=t.name.replace(",",""),i=i.toLocaleLowerCase(),t.name.toLocaleLowerCase().indexOf(i)>-1}ngAfterViewInit(){this.dataSource.sort=this.sort}sortData(i){const t=this.dataSource.data.slice();i.active&&""!==i.direction?(this.dataSource.data=t.sort((n,r)=>{if(!n.sortable||!r.sortable)return 1;{let o="asc"===i.direction;return"Name"===i.active?this.compare(n.name.toLowerCase(),r.name.toLowerCase(),o):0}}),this.dataSource=new c.I6(this.dataSource.data)):this.dataSource.data=t}compare(i,t,n){return i<t?-1*(n?1:-1):i>t?1*(n?1:-1):0*(n?1:-1)}applyFilter(i){const t={name:this.nameFilter.nativeElement.value,sortable:!0,ischecked:!1};this.dataSource.filterPredicate=(n,r)=>{const o=JSON.parse(r);return""==n.name||n.name.toLowerCase().includes(o.name.toLowerCase())},this.dataSource.filter=JSON.stringify(t),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}check(i,t,n){let r=new f,o=new R;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),r.id=t,r.name=n,r.ischecked=!0,r.sortable=!0,o.id=t,o.view=!0,null!=this.privilageRole.find(l=>l.id==t)?this.privilageRole.find(l=>l.id==t).view=!0:this.privilageRole.push(o),this.privilagesFilteredLst.push(r),this.privilageID.push(r.id),console.log("Privilage Id is "+this.privilageID),console.log(r)):(this.checkedrow=!1,r.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),r.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),r.id=t,r.name=n,o.id=t,o.view=!1,r.ischecked=!1,this.privilagesFilteredLst.pop(),null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).view=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(r),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid(i){return!!this.privilagesFilteredLst.find(t=>t.id==i&&1==t.ischecked)}check1(i,t,n){let r=new R,o=new f;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),o.id=t,o.name=n,o.sortable=!0,o.CanAdd=!0,r.id=t,r.add=!0,null!=this.privilageRole.find(l=>l.id==t)?this.privilageRole.find(l=>l.id==t).add=!0:this.privilageRole.push(r),this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o)):(this.checkedrow=!1,o.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),o.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),o.id=t,o.name=n,r.id=t,null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).add=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilagesFilteredLst.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid1(i){return!!this.privilagesFilteredLst.find(t=>t.id==i&&1==t.CanAdd)}check2(i,t,n){let r=new R,o=new f;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),o.id=t,o.name=n,o.sortable=!0,r.id=t,r.update=!0,r.view=!0,o.ischecked=!0,null!=this.privilageRole.find(l=>l.id==t)?(this.privilageRole.find(l=>l.id==t).update=!0,this.privilageRole.find(l=>l.id==t).view=!0):this.privilageRole.push(r),this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o)):(this.checkedrow=!1,o.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),o.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),o.id=t,o.name=n,r.id=t,null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).update=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilagesFilteredLst.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid2(i){return!!this.privilagesFilteredLst.find(t=>t.id==i&&1==t.CanUpdate)}check3(i,t,n){let r=new R,o=new f;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),o.id=t,o.name=n,o.sortable=!0,r.id=t,r.delete=!0,r.view=!0,o.ischecked=!0,null!=this.privilageRole.find(l=>l.id==t)?(this.privilageRole.find(l=>l.id==t).delete=!0,this.privilageRole.find(l=>l.id==t).view=!0):this.privilageRole.push(r),this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o)):(this.checkedrow=!1,o.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),o.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),o.id=t,o.name=n,r.id=t,null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).delete=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilagesFilteredLst.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid3(i){return!!this.privilagesFilteredLst.find(t=>t.id==i&&1==t.CanDelete)}onSubmit(){if(this.submitted=!0,this.isSubmitted=!0,this.roleForm.invalid)return;let t={roleName:this.roleForm.value.roleName,privilage:this.privilageRole};t.privilage=this.privilageRole,1==!/\S/.test(t.roleName)?this.toastrService.danger("\u064a\u062c\u0628 \u0625\u062f\u062e\u0627\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062f\u0648\u0631 \u0644\u0625\u062a\u0645\u0627\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062d\u0641\u0638","\u062e\u0637\u0623"):this.role.addRole(t).subscribe({next:r=>{this.toastrService.Create(F.C.Role),this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles")},error:r=>{this.toastrService.danger(r.error.error,"\u062e\u0637\u0623"),this.submitted=!1,this.isSubmitted=!1}})}addToGrant(i,t,n,r){this.submitted=!0,this.isSubmitted=!1;let o=new f;this.index++,console.log(this.index),o.id=i,o.name=t,this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o)}ShowAdd(){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/PlanParts/add/22")}get fc(){return this.roleForm.controls}get grantFiles(){return this.grantFiles.controls.grantFiles}showOwners(){this.name="Grant Owners are ";let i=this.translate.get("Owners",{entity:name}).toPromise(),t=this.translate.get("DeleteMessage",{entity:name}).toPromise();this.dialogService.open(b.w,{context:{title:`${i}`,body:`${t}?`}})}get privilage(){return this.privilage.controls.privilage}static{this.\u0275fac=function(t){return new(t||s)(e.rXU(p.ok),e.rXU(g.Ix),e.rXU(g.nX),e.rXU(k.t),e.rXU(m.c$),e.rXU(e.gRc),e.rXU(d.S0W),e.rXU(w.W))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-add-role"]],viewQuery:function(t,n){if(1&t&&(e.GBs(_.iy,5),e.GBs(u.B4,5),e.GBs(x,5)),2&t){let r;e.mGM(r=e.lsd())&&(n.paginator=r.first),e.mGM(r=e.lsd())&&(n.sort=r.first),e.mGM(r=e.lsd())&&(n.nameFilter=r.first)}},decls:47,vars:27,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-6"],[1,"form-group"],["for","Role",1,"label"],["type","text","formControlName","roleName","nbInput","","shape","round","fullWidth","","id","roleName"],[4,"ngIf"],["for","noOfOwners",1,"label"],[1,"table-container"],["mat-table","","matSort","","matSortDisableClear","","matSortDirection","asc",1,"users-table","table-striped",3,"dataSource","matSortChange"],["matColumnDef","Name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","ischecked"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","CanAdd"],["matColumnDef","CanUpdate"],["matColumnDef","CanDelete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"dir","length","pageIndex","pageSize","pageSizeOptions","page"],[1,"row","mt-2"],["type","submit","status","primary","nbButton","",1,"offset-md-11",3,"disabled"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf","ngIfElse"],["data",""],["type","text","nbInput","","matInput","","placeholder","name",1,"text-center",3,"keyup"],["nameFilter",""],["mat-header-cell",""],["type","checkbox",3,"checked","change"],["mat-header-row",""],["mat-row",""]],template:function(t,n){1&t&&(e.j41(0,"nb-card")(1,"nb-card-header")(2,"h5"),e.EFF(3),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s()(),e.j41(6,"nb-card-body")(7,"form",0),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(8,"div",1)(9,"div",2)(10,"div",3)(11,"label",4)(12,"h6"),e.EFF(13),e.nI1(14,"translate"),e.k0s()(),e.nrm(15,"input",5),e.DNE(16,M,3,3,"mat-error",6),e.k0s()(),e.j41(17,"div",2)(18,"div",3)(19,"label",7)(20,"h6"),e.EFF(21),e.nI1(22,"translate"),e.k0s()()()()(),e.j41(23,"nb-card",8)(24,"table",9),e.bIt("matSortChange",function(o){return n.sortData(o)}),e.qex(25,10),e.DNE(26,L,3,3,"th",11),e.DNE(27,A,4,2,"td",12),e.bVm(),e.qex(28,13),e.DNE(29,U,3,3,"th",14),e.DNE(30,X,2,1,"td",12),e.bVm(),e.qex(31,15),e.DNE(32,V,2,0,"th",14),e.DNE(33,H,4,2,"td",12),e.bVm(),e.qex(34,16),e.DNE(35,J,2,0,"th",14),e.DNE(36,K,4,2,"td",12),e.bVm(),e.qex(37,17),e.DNE(38,ee,2,0,"th",14),e.DNE(39,ne,4,2,"td",12),e.bVm(),e.DNE(40,re,1,0,"tr",18),e.DNE(41,oe,1,0,"tr",19),e.k0s()(),e.j41(42,"mat-paginator",20),e.bIt("page",function(o){return n.search(o)}),e.k0s(),e.j41(43,"div",21)(44,"button",22),e.EFF(45),e.nI1(46,"translate"),e.k0s()()()()()),2&t&&(e.R7$(3),e.Lme("",e.bMT(4,17,"Add")," ",e.bMT(5,19,"Roles")," "),e.R7$(4),e.Y8G("formGroup",n.roleForm),e.R7$(6),e.SpI(" ",e.bMT(14,21,"Role")," "),e.R7$(3),e.Y8G("ngIf",n.fc.roleName.touched&&n.fc.roleName.hasError("required")),e.R7$(5),e.Lme(" ",e.bMT(22,23,"No-Of-Privilages")," ",n.index," "),e.R7$(3),e.Y8G("dataSource",n.dataSource),e.R7$(16),e.Y8G("matHeaderRowDef",n.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",n.displayedColumns),e.R7$(1),e.Y8G("dir",n.dir)("length",n.totalRecords)("pageIndex",n.searchModel.PageNumber-1)("pageSize",n.searchModel.PageSize)("pageSizeOptions",n.pageSizeOptions),e.R7$(2),e.Y8G("disabled",n.roleForm.invalid||n.isSubmitted),e.R7$(1),e.JRh(e.bMT(46,25,"Save")))},dependencies:[d.SrT,d.KH5,d.zJv,d.YP2,d.i6h,C.bT,p.qT,p.me,p.BC,p.cb,p.j4,p.JD,E.ig,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,u.B4,u.aE,_.iy,m.D9]})}}return s})();const ae=["nameFilter"];function ce(s,a){1&s&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"roleName is Required")," "))}function de(s,a){1&s&&(e.j41(0,"th",24),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Permissions")," "))}function he(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",28,29),e.bIt("keyup",function(n){e.eBV(i);const r=e.XpG(2);return e.Njj(r.applyFilter(n))}),e.k0s()()}}function pe(s,a){if(1&s&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&s){const i=e.XpG().$implicit;e.R7$(1),e.JRh(i.name)}}function ue(s,a){if(1&s&&(e.j41(0,"td",25),e.DNE(1,he,3,0,"span",26),e.DNE(2,pe,2,1,"ng-template",null,27,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==i.name)("ngIfElse",t)}}function me(s,a){1&s&&(e.j41(0,"th",30),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI("",e.bMT(2,1,"ListAndSearch")," "))}function ge(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",31),e.bIt("change",function(n){e.eBV(i);const r=e.XpG().$implicit,o=e.XpG();return e.Njj(o.check(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG().$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid(i.id))}}function fe(s,a){if(1&s&&(e.j41(0,"td",25),e.DNE(1,ge,2,1,"span",6),e.k0s()),2&s){const i=a.$implicit;e.R7$(1),e.Y8G("ngIf",""!=i.name)}}function _e(s,a){1&s&&(e.j41(0,"th",30),e.EFF(1," \u0627\u0644\u0627\u0636\u0627\u0641\u0629"),e.k0s())}function ve(s,a){1&s&&e.nrm(0,"span")}function Re(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",31),e.bIt("change",function(n){e.eBV(i);const r=e.XpG(2).$implicit,o=e.XpG();return e.Njj(o.check1(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid1(i.id))}}function Ie(s,a){if(1&s&&e.DNE(0,Re,2,1,"span",6),2&s){const i=e.XpG().$implicit;e.Y8G("ngIf",""!=i.name)}}function Ce(s,a){if(1&s&&(e.j41(0,"td",25),e.DNE(1,ve,1,0,"span",26),e.DNE(2,Ie,1,1,"ng-template",null,27,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",1==i.viewActionOnly)("ngIfElse",t)}}function Se(s,a){1&s&&(e.j41(0,"th",30),e.EFF(1," \u0627\u0644\u062a\u0639\u062f\u064a\u0644"),e.k0s())}function be(s,a){1&s&&e.nrm(0,"span")}function ke(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",31),e.bIt("change",function(n){e.eBV(i);const r=e.XpG(2).$implicit,o=e.XpG();return e.Njj(o.check2(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid2(i.id))}}function we(s,a){if(1&s&&e.DNE(0,ke,2,1,"span",6),2&s){const i=e.XpG().$implicit;e.Y8G("ngIf",""!=i.name)}}function Ee(s,a){if(1&s&&(e.j41(0,"td",25),e.DNE(1,be,1,0,"span",26),e.DNE(2,we,1,1,"ng-template",null,27,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",1==i.viewActionOnly)("ngIfElse",t)}}function De(s,a){1&s&&(e.j41(0,"th",30),e.EFF(1," \u0627\u0644\u062d\u0630\u0641"),e.k0s())}function ye(s,a){1&s&&e.nrm(0,"span")}function Pe(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",31),e.bIt("change",function(n){e.eBV(i);const r=e.XpG(2).$implicit,o=e.XpG();return e.Njj(o.check3(n,r.id,r.name))}),e.k0s()()}if(2&s){const i=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("checked",t.returnValueByelementid3(i.id))}}function Fe(s,a){if(1&s&&e.DNE(0,Pe,2,1,"span",6),2&s){const i=e.XpG().$implicit;e.Y8G("ngIf",""!=i.name)}}function Te(s,a){if(1&s&&(e.j41(0,"td",25),e.DNE(1,ye,1,0,"span",26),e.DNE(2,Fe,1,1,"ng-template",null,27,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",1==i.viewActionOnly)("ngIfElse",t)}}function Ne(s,a){1&s&&e.nrm(0,"tr",32)}function Ge(s,a){1&s&&e.nrm(0,"tr",33)}let $e=(()=>{class s{constructor(i,t,n,r,o,l,I,D){this.formBuilder=i,this.router=t,this.route=n,this.toastrService=r,this.translate=o,this._detector=l,this.dialogService=I,this.role=D,this.dir="ltr",this.totalRecords=0,this.pageSizeOptions=v.c.DEFAULT_PAGE_SIZE_OPTIONS,this.submitted=!1,this.isSubmitted=!1,this.privilages=[],this.isLoading=!1,this.EverId=[],this.AttachmentsssId=[],this.index=0,this.privilageID=[],this.OwnersName=[],this.test=!0,this.TypeOfGrant=0,this.displayedColumns=["Name","ischecked","CanAdd","CanUpdate","CanDelete"],this.privilagesFilteredLst=[],this.checkedrows=[],this.privilageRole=[],(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth")}ngOnInit(){this.initForm(),this.route.params.subscribe(i=>{this.Id=i.id}),this.getRoleInfoById(),this.searchModel={id:this.Id,PageNumber:1,PageSize:v.c.DEFAULT_PAGE_SIZE},this.search()}GetPrivilages(){this.role.ListAllPrivlages({PageNumber:1,PageSize:1e3}).subscribe(i=>{this.privilages=i.entity.entities})}getRoleInfoById(){this.role.getById(this.Id).subscribe(i=>{this.currentRole=i.entity,this.bindForm()})}bindForm(){this.roleForm.controls.id.setValue(this.Id),this.roleForm.controls.roleName.setValue(this.currentRole.roleName)}search(i){i?(this.searchModel.id=this.Id,this.searchModel.PageNumber=i.pageIndex+1,this.searchModel.PageSize=i.pageSize):(this.searchModel.id=this.Id,this.searchModel.PageNumber=1,this.searchModel.PageSize=10),this.role.ListAllPrivlagesFilterByRoleId(this.searchModel).subscribe(t=>{this.privilages=t.entity.entities,this.totalRecords=t.entity.totalRecords,this.totalRecordSelected=t.entity.entities.filter(n=>1==n.ischecked).length,this.index=this.totalRecordSelected,this.dataSource=new c.I6(this.privilages),this._detector.markForCheck()}),this.role.ListAllPrivlagesActionByRoleId(this.searchModel).subscribe(t=>{this.privilageRole=t.entity.entities})}initForm(){this.roleForm=this.formBuilder.group({id:[null],roleName:["",[p.k0.required]],privilage:this.formBuilder.array([])})}CustomSearchFn(i,t){return t.name=t.name.replace(",",""),i=i.toLocaleLowerCase(),t.name.toLocaleLowerCase().indexOf(i)>-1}ngAfterViewInit(){this.dataSource.sort=this.sort}sortData(i){const t=this.dataSource.data.slice();i.active&&""!==i.direction?(this.dataSource.data=t.sort((n,r)=>{if(!n.sortable||!r.sortable)return 1;{let o="asc"===i.direction;return"Name"===i.active?this.compare(n.name.toLowerCase(),r.name.toLowerCase(),o):0}}),this.dataSource=new c.I6(this.dataSource.data)):this.dataSource.data=t}compare(i,t,n){return i<t?-1*(n?1:-1):i>t?1*(n?1:-1):0*(n?1:-1)}applyFilter(i){const t={name:this.nameFilter.nativeElement.value,sortable:!0,ischecked:!1};this.dataSource.filterPredicate=(n,r)=>{const o=JSON.parse(r);return""==n.name||n.name.toLowerCase().includes(o.name.toLowerCase())},this.dataSource.filter=JSON.stringify(t),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}returnValueByelementid(i){return!(!this.privilageRole.find(t=>t==i&&1==t.view)&&!this.privilages.find(t=>t.id==i&&1==t.ischecked))}check(i,t,n){let r=new f,o=new R;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),r.id=t,r.name=n,r.ischecked=!0,r.sortable=!0,o.id=t,o.view=!0,null!=this.privilageRole.find(l=>l.id==t)?this.privilageRole.find(l=>l.id==t).view=!0:this.privilageRole.push(o),this.privilagesFilteredLst.push(r),this.privilageID.push(r.id),console.log("Privilage Id is "+this.privilageID),console.log(r),console.log(this.privilageRole),console.log("o1 is= "+o)):(this.checkedrow=!1,r.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),r.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),r.id=t,r.name=n,o.id=t,o.view=!1,r.ischecked=!1,this.privilagesFilteredLst.pop(),null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).view=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(r),console.log("Privilage Id is222 "+this.privilageID))}check1(i,t,n){let r=new R,o=new f;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),o.id=t,o.name=n,o.sortable=!0,o.CanAdd=!0,r.id=t,r.add=!0,null!=this.privilageRole.find(l=>l.id==t)?this.privilageRole.find(l=>l.id==t).add=!0:this.privilageRole.push(r),this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("o1="+r)):(this.checkedrow=!1,o.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),o.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),o.id=t,o.name=n,r.id=t,null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).add=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilagesFilteredLst.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid1(i){return!(!this.privilageRole.find(t=>t==i&&1==t.add)&&!this.privilages.find(t=>t.id==i&&1==t.canAdd))}check2(i,t,n){let r=new R,o=new f;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),o.id=t,o.name=n,o.sortable=!0,r.id=t,r.update=!0,r.view=!0,o.ischecked=!0,null!=this.privilageRole.find(l=>l.id==t)?(this.privilageRole.find(l=>l.id==t).update=!0,this.privilageRole.find(l=>l.id==t).view=!0):this.privilageRole.push(r),this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("o1="+r)):(this.checkedrow=!1,o.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),o.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),o.id=t,o.name=n,r.id=t,null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).update=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilagesFilteredLst.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid2(i){return!!(this.privilagesFilteredLst.find(t=>t.id==i&&1==t.CanUpdate)||this.privilageRole.find(t=>t==i&&1==t.update)||this.privilages.find(t=>t.id==i&&1==t.canUpdate))}check3(i,t,n){let r=new R,o=new f;1==i.currentTarget.checked?(this.checkedrow=!0,this.checkedrows.push(!0),console.log("CheckedRowsssss"+this.checkedrows),console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.submitted=!0,this.isSubmitted=!1,this.index++,console.log(this.index),o.id=t,o.name=n,o.sortable=!0,r.id=t,r.delete=!0,r.view=!0,o.ischecked=!0,null!=this.privilageRole.find(l=>l.id==t)?(this.privilageRole.find(l=>l.id==t).delete=!0,this.privilageRole.find(l=>l.id==t).view=!0):this.privilageRole.push(r),this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("o1="+r)):(this.checkedrow=!1,o.ischecked=!1,this.checkedrows.pop(),console.log("CheckedRowsssss"+this.checkedrows),o.sortable=!1,console.log("checkBoxEvent  "+i.currentTarget.checked,t),this.index--,console.log(this.index),o.id=t,o.name=n,r.id=t,null!=this.privilageRole.find(l=>l.id==t)&&(this.privilageRole.find(l=>l.id==t).delete=!1),null!=this.privilageRole.find(l=>l.id==t&&0==l.add&&0==l.delete&&0==l.update&&0==l.view)&&this.privilageRole.pop(),this.privilagesFilteredLst.pop(),this.privilageID.pop(),console.log("Privilage Id is "+this.privilageID),console.log(o),console.log("Privilage Id is222 "+this.privilageID))}returnValueByelementid3(i){return!!(this.privilagesFilteredLst.find(t=>t.id==i&&1==t.CanDelete)||this.privilageRole.find(t=>t==i&&1==t.delete)||this.privilages.find(t=>t.id==i&&1==t.canDelete))}onSubmit(){if(this.submitted=!0,this.isSubmitted=!0,this.roleForm.invalid)return;let t={id:this.Id,roleName:this.roleForm.value.roleName,privilage:this.privilageRole};t.id=this.Id,1==!/\S/.test(t.roleName)?this.toastrService.danger("\u064a\u062c\u0628 \u0625\u062f\u062e\u0627\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062f\u0648\u0631 \u0644\u0625\u062a\u0645\u0627\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062d\u0641\u0638","\u062e\u0637\u0623"):this.role.updateRole(t).subscribe({next:r=>{this.toastrService.Update(F.C.Role),console.log("dsd",this.privilageID),this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles")},error:r=>{this.toastrService.danger(r.error.error,"\u062e\u0637\u0623"),this.submitted=!1,this.isSubmitted=!1}})}addToGrant(i,t,n,r){this.submitted=!0,this.isSubmitted=!1;let o=new f;this.index++,console.log(this.index),o.id=i,o.name=t,this.privilagesFilteredLst.push(o),this.privilageID.push(o.id),console.log("Privilage Id is "+this.privilageID),console.log(o)}ShowAdd(){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/PlanParts/add/22")}get fc(){return this.roleForm.controls}get grantFiles(){return this.grantFiles.controls.grantFiles}showOwners(){this.name="Grant Owners are ";let i=this.translate.get("Owners",{entity:name}).toPromise(),t=this.translate.get("DeleteMessage",{entity:name}).toPromise();this.dialogService.open(b.w,{context:{title:`${i}`,body:`${t}?`}})}get privilage(){return this.privilage.controls.privilage}static{this.\u0275fac=function(t){return new(t||s)(e.rXU(p.ok),e.rXU(g.Ix),e.rXU(g.nX),e.rXU(k.t),e.rXU(m.c$),e.rXU(e.gRc),e.rXU(d.S0W),e.rXU(w.W))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-edit-role"]],viewQuery:function(t,n){if(1&t&&(e.GBs(_.iy,5),e.GBs(u.B4,5),e.GBs(ae,5)),2&t){let r;e.mGM(r=e.lsd())&&(n.paginator=r.first),e.mGM(r=e.lsd())&&(n.sort=r.first),e.mGM(r=e.lsd())&&(n.nameFilter=r.first)}},decls:47,vars:28,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-6"],[1,"form-group"],["for","Role",1,"label"],["type","text","formControlName","roleName","nbInput","","shape","round","fullWidth","","id","roleName"],[4,"ngIf"],[1,"col-sm-6",3,"hidden"],["for","noOfOwners",1,"label"],[1,"table-container"],["mat-table","","matSort","","matSortDisableClear","","matSortDirection","asc",1,"users-table","table-striped",3,"dataSource","matSortChange"],["matColumnDef","Name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","ischecked"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","CanAdd"],["matColumnDef","CanUpdate"],["matColumnDef","CanDelete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"dir","length","pageIndex","pageSize","pageSizeOptions","page"],[1,"row","mt-2"],["type","submit","status","primary","nbButton","",1,"offset-md-11",3,"disabled"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf","ngIfElse"],["data",""],["type","text","nbInput","","matInput","","placeholder","name",1,"text-center",3,"keyup"],["nameFilter",""],["mat-header-cell",""],["type","checkbox",3,"checked","change"],["mat-header-row",""],["mat-row",""]],template:function(t,n){1&t&&(e.j41(0,"nb-card")(1,"nb-card-header")(2,"h5"),e.EFF(3),e.nI1(4,"translate"),e.nI1(5,"translate"),e.k0s()(),e.j41(6,"nb-card-body")(7,"form",0),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(8,"div",1)(9,"div",2)(10,"div",3)(11,"label",4)(12,"h6"),e.EFF(13),e.nI1(14,"translate"),e.k0s()(),e.nrm(15,"input",5),e.DNE(16,ce,3,3,"mat-error",6),e.k0s()(),e.j41(17,"div",7)(18,"div",3)(19,"label",8)(20,"h6"),e.EFF(21),e.nI1(22,"translate"),e.k0s()()()()(),e.j41(23,"nb-card",9)(24,"table",10),e.bIt("matSortChange",function(o){return n.sortData(o)}),e.qex(25,11),e.DNE(26,de,3,3,"th",12),e.DNE(27,ue,4,2,"td",13),e.bVm(),e.qex(28,14),e.DNE(29,me,3,3,"th",15),e.DNE(30,fe,2,1,"td",13),e.bVm(),e.qex(31,16),e.DNE(32,_e,2,0,"th",15),e.DNE(33,Ce,4,2,"td",13),e.bVm(),e.qex(34,17),e.DNE(35,Se,2,0,"th",15),e.DNE(36,Ee,4,2,"td",13),e.bVm(),e.qex(37,18),e.DNE(38,De,2,0,"th",15),e.DNE(39,Te,4,2,"td",13),e.bVm(),e.DNE(40,Ne,1,0,"tr",19),e.DNE(41,Ge,1,0,"tr",20),e.k0s()(),e.j41(42,"mat-paginator",21),e.bIt("page",function(o){return n.search(o)}),e.k0s(),e.j41(43,"div",22)(44,"button",23),e.EFF(45),e.nI1(46,"translate"),e.k0s()()()()()),2&t&&(e.R7$(3),e.Lme("",e.bMT(4,18,"Edit")," ",e.bMT(5,20,"Roles")," "),e.R7$(4),e.Y8G("formGroup",n.roleForm),e.R7$(6),e.SpI(" ",e.bMT(14,22,"Role")," "),e.R7$(3),e.Y8G("ngIf",n.fc.roleName.touched&&n.fc.roleName.hasError("required")),e.R7$(1),e.Y8G("hidden",!0),e.R7$(4),e.Lme(" ",e.bMT(22,24,"No-Of-Privilages")," ",n.index," "),e.R7$(3),e.Y8G("dataSource",n.dataSource),e.R7$(16),e.Y8G("matHeaderRowDef",n.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",n.displayedColumns),e.R7$(1),e.Y8G("dir",n.dir)("length",n.totalRecords)("pageIndex",n.searchModel.PageNumber-1)("pageSize",n.searchModel.PageSize)("pageSizeOptions",n.pageSizeOptions),e.R7$(2),e.Y8G("disabled",n.roleForm.invalid||n.isSubmitted),e.R7$(1),e.JRh(e.bMT(46,26,"Save")))},dependencies:[d.SrT,d.KH5,d.zJv,d.YP2,d.i6h,C.bT,p.qT,p.me,p.BC,p.cb,p.j4,p.JD,E.ig,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,u.B4,u.aE,_.iy,m.D9]})}}return s})();var S=h(467);const xe=["nameFilter"];function Me(s,a){if(1&s&&(e.j41(0,"option",15),e.EFF(1),e.k0s()),2&s){const i=a.$implicit;e.FS9("value",i.id),e.R7$(1),e.SpI(" ",i.roleName," ")}}function Le(s,a){1&s&&(e.j41(0,"th",16),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Permissions")," "))}function Be(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",20,21),e.bIt("keyup",function(n){e.eBV(i);const r=e.XpG(2);return e.Njj(r.applyFilter(n))}),e.k0s()()}}function je(s,a){if(1&s&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&s){const i=e.XpG().$implicit;e.R7$(1),e.JRh(i.name)}}function Ae(s,a){if(1&s&&(e.j41(0,"td",17),e.DNE(1,Be,3,0,"span",18),e.DNE(2,je,2,1,"ng-template",null,19,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==i.name)("ngIfElse",t)}}function Ue(s,a){1&s&&e.nrm(0,"tr",22)}function Oe(s,a){1&s&&e.nrm(0,"tr",23)}let T=(()=>{class s{constructor(i,t,n,r,o,l,I){this.toastrService=i,this.translate=t,this.roleService=n,this.router=r,this.route=o,this._detector=l,this.dialogService=I,this.dir="ltr",this.totalRecords=0,this.pageSizeOptions=v.c.DEFAULT_PAGE_SIZE_OPTIONS,this.displayedColumns=["Name"],this.roleModel=[],this.privalageModel=[],(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth"),"ar"==t.currentLang&&(this.dir="rtl")}ngOnInit(){this.getRoles(),this.route.params.subscribe(i=>{this.roleId=i.id}),null!=this.roleId&&this.searchWithId(),this.searchModel={PageNumber:1,PageSize:v.c.DEFAULT_PAGE_SIZE},this.searchModelWithId={id:this.roleId,PageNumber:1,PageSize:v.c.DEFAULT_PAGE_SIZE},this.search(),this._detector.markForCheck()}ngAfterViewInit(){this.dataSource.sort=this.sort}getRoles(){console.log("PlanService"),this.roleService.ListRoles({PageNumber:1,PageSize:1e3}).subscribe(i=>{this.roleModel=i.entity.entities})}selectChangeHandler(i){this.roleId=i.target.value,console.log("This.RoleId="+this.roleId),this.searchWithId()}sortData(i){const t=this.dataSource.data.slice();i.active&&""!==i.direction?(this.dataSource.data=t.sort((n,r)=>{if(!n.sortable||!r.sortable)return 1;{let o="asc"===i.direction;return"Name"===i.active?this.compare(n.name.toLowerCase(),r.name.toLowerCase(),o):0}}),this.dataSource=new c.I6(this.dataSource.data)):this.dataSource.data=t}compare(i,t,n){return i<t?-1*(n?1:-1):i>t?1*(n?1:-1):0*(n?1:-1)}applyFilter(i){const t={roleName:this.nameFilter.nativeElement.value.trim(),sortable:!0};this.dataSource.filterPredicate=(n,r)=>{const o=JSON.parse(r);return""==n.name||n.name.toLowerCase().includes(o.name.toLowerCase())},this.dataSource.filter=JSON.stringify(t),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}search(i){var t=this;return(0,S.A)(function*(){i?(t.searchModel.PageNumber=i.pageIndex+1,t.searchModel.PageSize=i.pageSize):(t.searchModel.PageNumber=1,t.searchModel.PageSize=10),t.roleService.ListAllPrivlages(t.searchModel).subscribe(n=>{t.privalageModel=n.entity.entities,t.totalRecords=n.entity.totalRecords,t._detector.markForCheck(),t.dataSource=new c.I6(t.privalageModel)})})()}searchWithId(i){var t=this;return(0,S.A)(function*(){i?(t.searchModelWithId.id=t.roleId,t.searchModelWithId.PageNumber=i.pageIndex+1,t.searchModelWithId.PageSize=i.pageSize):(t.searchModelWithId.id=t.roleId,t.searchModelWithId.PageNumber=1,t.searchModelWithId.PageSize=10),t.roleService.ListAllPrivlagesByRoleId(t.searchModelWithId).subscribe(n=>{t.privalageModel=n.entity.entities,t.totalRecords=n.entity.totalRecords,t._detector.markForCheck(),t.dataSource=new c.I6(t.privalageModel)})})()}delete(i,t){var n=this;return(0,S.A)(function*(){t=yield n.translate.get(t).toPromise();let r=yield n.translate.get("DeleteTitle",{entity:t}).toPromise(),o=yield n.translate.get("DeleteMessage",{entity:t}).toPromise();n.dialogService.open(b.w,{context:{title:`${r}`,body:`${o}?`},closeOnBackdropClick:!1}).onClose.subscribe(l=>{})})()}ShowPrivilage(i){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Grant/list/"+i)}ShowAddGrant(i){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/add/")}ShowAdd(){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/add")}ShowEdit(i){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/edit/"+i)}static{this.\u0275fac=function(t){return new(t||s)(e.rXU(k.t),e.rXU(m.c$),e.rXU(w.W),e.rXU(g.Ix),e.rXU(g.nX),e.rXU(e.gRc),e.rXU(d.S0W))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-list-privilages"]],viewQuery:function(t,n){if(1&t&&(e.GBs(u.B4,5),e.GBs(_.iy,5),e.GBs(xe,5)),2&t){let r;e.mGM(r=e.lsd())&&(n.sort=r.first),e.mGM(r=e.lsd())&&(n.paginator=r.first),e.mGM(r=e.lsd())&&(n.nameFilter=r.first)}},decls:22,vars:12,consts:[[1,"container"],[1,"table-container","pb-3"],[1,"row","row-cols-3","w-40","h-10"],[1,"col"],["name","selectedOption2",1,"form-control",2,"font-size","22px",3,"change"],["value","0"],[3,"value",4,"ngFor","ngForOf"],[1,"table-container"],["mat-table","","matSort","","matSortDisableClear","","matSortDirection","asc",1,"users-table","table-striped",3,"dataSource","matSortChange"],["matColumnDef","Name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"dir","length","pageIndex","pageSize","pageSizeOptions","page"],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf","ngIfElse"],["data",""],["type","text","nbInput","","matInput","","placeholder","\u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0629",1,"text-center",3,"keyup"],["nameFilter",""],["mat-header-row",""],["mat-row",""]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"nb-card",1)(2,"nb-card-header")(3,"h4"),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"div",2)(7,"div",3)(8,"select",4),e.bIt("change",function(o){return n.selectChangeHandler(o)}),e.j41(9,"option",5),e.EFF(10,"\u0627\u0644\u062f\u0648\u0631"),e.k0s(),e.DNE(11,Me,2,2,"option",6),e.k0s()(),e.nrm(12,"div",3)(13,"div",3),e.k0s()()(),e.j41(14,"nb-card",7)(15,"table",8),e.bIt("matSortChange",function(o){return n.sortData(o)}),e.qex(16,9),e.DNE(17,Le,3,3,"th",10),e.DNE(18,Ae,4,2,"td",11),e.bVm(),e.DNE(19,Ue,1,0,"tr",12),e.DNE(20,Oe,1,0,"tr",13),e.k0s()(),e.j41(21,"mat-paginator",14),e.bIt("page",function(o){return n.search(o)}),e.k0s()()),2&t&&(e.R7$(4),e.SpI(" ",e.bMT(5,10,"Privilages"),""),e.R7$(7),e.Y8G("ngForOf",n.roleModel),e.R7$(4),e.Y8G("dataSource",n.dataSource),e.R7$(4),e.Y8G("matHeaderRowDef",n.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",n.displayedColumns),e.R7$(1),e.Y8G("dir",n.dir)("length",n.totalRecords)("pageIndex",n.searchModel.PageNumber-1)("pageSize",n.searchModel.PageSize)("pageSizeOptions",n.pageSizeOptions))},dependencies:[d.SrT,d.zJv,d.i6h,C.Sq,C.bT,p.xH,p.y7,E.ig,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,u.B4,u.aE,_.iy,m.D9],styles:[".table-container[_ngcontent-%COMP%]{border-radius:2rem;overflow-x:scroll;overflow-y:auto}table[_ngcontent-%COMP%]{width:20rem}.search-container[_ngcontent-%COMP%]{margin:1rem auto;display:flex;justify-content:center}.col-md-4[_ngcontent-%COMP%], .col-md-6[_ngcontent-%COMP%], .col-md-12[_ngcontent-%COMP%]{padding:5px!important}.users-table[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;border-collapse:collapse}tr[_ngcontent-%COMP%]{height:3.2rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center!important;padding:10px}th[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1.3rem}  .mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0;justify-content:center}"]})}}return s})();const Xe=["roleNameFilter"];function Ve(s,a){1&s&&(e.j41(0,"th",14),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Roles")," "))}function Ye(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"input",18,19),e.bIt("keyup",function(n){e.eBV(i);const r=e.XpG(2);return e.Njj(r.applyFilter(n))}),e.nI1(3,"translate"),e.k0s()()}2&s&&(e.R7$(1),e.Y8G("placeholder",e.bMT(3,1,"Role")))}function ze(s,a){if(1&s&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&s){const i=e.XpG().$implicit;e.R7$(1),e.JRh(i.roleName)}}function We(s,a){if(1&s&&(e.j41(0,"td",15),e.DNE(1,Ye,4,3,"span",16),e.DNE(2,ze,2,1,"ng-template",null,17,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==i.roleName)("ngIfElse",t)}}function He(s,a){1&s&&e.nrm(0,"th",20)}function Je(s,a){1&s&&e.nrm(0,"span")}function Ze(s,a){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"button",21),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.ShowEdit(n.id))}),e.j41(2,"mat-icon"),e.EFF(3,"edit"),e.k0s()()()}if(2&s){const i=e.XpG(2);e.R7$(1),e.Y8G("hidden",!i.canEdit)}}function qe(s,a){if(1&s&&(e.j41(0,"td",15),e.DNE(1,Je,1,0,"span",16),e.DNE(2,Ze,4,1,"ng-template",null,17,e.C5r),e.k0s()),2&s){const i=a.$implicit,t=e.sdS(3);e.R7$(1),e.Y8G("ngIf",0==i.sortable)("ngIfElse",t)}}function Qe(s,a){1&s&&e.nrm(0,"tr",22)}function Ke(s,a){1&s&&e.nrm(0,"tr",23)}const et=[{path:"",component:(()=>{class s{constructor(i,t,n,r,o,l,I){this.toastrService=i,this.translate=t,this.roleService=n,this.router=r,this.route=o,this._detector=l,this.dialogService=I,this.dir="ltr",this.totalRecords=0,this.pageSizeOptions=v.c.DEFAULT_PAGE_SIZE_OPTIONS,this.displayedColumns=["Role","actions2"],this.roleModel=[],(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth"),"ar"==t.currentLang&&(this.dir="rtl")}ngOnInit(){this.searchModel={PageNumber:1,PageSize:v.c.DEFAULT_PAGE_SIZE},this.search(),this._detector.markForCheck(),this.roleService.getActionByRoleId(localStorage.getItem("RoleId"),"Roles").subscribe(i=>{this.canAdd=i.entity.add,this.canEdit=i.entity.update,this.canDelete=i.entity.delete})}ngAfterViewInit(){this.dataSource.sort=this.sort}sortData(i){const t=this.dataSource.data.slice();i.active&&""!==i.direction?(this.dataSource.data=t.sort((n,r)=>{if(!n.sortable||!r.sortable)return 1;{let o="asc"===i.direction;return"Role"===i.active?this.compare(n.roleName.toLowerCase(),r.roleName.toLowerCase(),o):0}}),this.dataSource=new c.I6(this.dataSource.data)):this.dataSource.data=t}compare(i,t,n){return i<t?-1*(n?1:-1):i>t?1*(n?1:-1):0*(n?1:-1)}applyFilter(i){const t={roleName:this.roleNameFilter.nativeElement.value.trim(),sortable:!0};this.dataSource.filterPredicate=(n,r)=>{const o=JSON.parse(r);return""==n.roleName||n.roleName.toLowerCase().includes(o.roleName.toLowerCase())},this.dataSource.filter=JSON.stringify(t),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}search(i){var t=this;return(0,S.A)(function*(){i?(t.searchModel.PageNumber=i.pageIndex+1,t.searchModel.PageSize=i.pageSize):(t.searchModel.PageNumber=1,t.searchModel.PageSize=10),t.roleService.ListRoles(t.searchModel).subscribe(n=>{t.roleModel=n.entity.entities,t.totalRecords=n.entity.totalRecords,t._detector.markForCheck(),t.dataSource=new c.I6(t.roleModel)})})()}delete(i,t){var n=this;return(0,S.A)(function*(){t=yield n.translate.get(t).toPromise();let r=yield n.translate.get("DeleteTitle",{entity:t}).toPromise(),o=yield n.translate.get("DeleteMessage",{entity:t}).toPromise();n.dialogService.open(b.w,{context:{title:`${r}`,body:`${o}?`},closeOnBackdropClick:!1}).onClose.subscribe(l=>{})})()}ShowPrivilage(i){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/Permissions/"+i)}ShowAddGrant(i){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/Permissions")}ShowAdd(){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/add")}ShowEdit(i){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Roles/edit/"+i)}static{this.\u0275fac=function(t){return new(t||s)(e.rXU(k.t),e.rXU(m.c$),e.rXU(w.W),e.rXU(g.Ix),e.rXU(g.nX),e.rXU(e.gRc),e.rXU(d.S0W))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-list-role"]],viewQuery:function(t,n){if(1&t&&(e.GBs(u.B4,5),e.GBs(_.iy,5),e.GBs(Xe,5)),2&t){let r;e.mGM(r=e.lsd())&&(n.sort=r.first),e.mGM(r=e.lsd())&&(n.paginator=r.first),e.mGM(r=e.lsd())&&(n.roleNameFilter=r.first)}},decls:23,vars:15,consts:[[1,"container"],[1,"table-container","pb-3"],[1,"table-container"],[1,"col","d-flex"],["type","button",1,"special-button","mb-3",3,"hidden","click"],["mat-table","","matSort","","matSortDisableClear","","matSortDirection","asc",1,"users-table","table-striped",3,"dataSource","matSortChange"],["matColumnDef","Role"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions2"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"dir","length","pageIndex","pageSize","pageSizeOptions","page"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf","ngIfElse"],["data",""],["type","text","nbInput","","matInput","",1,"text-center",3,"placeholder","keyup"],["roleNameFilter",""],["mat-header-cell",""],["mat-mini-fab","","color","primary",3,"hidden","click"],["mat-header-row",""],["mat-row",""]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"nb-card",1)(2,"nb-card-header")(3,"h4"),e.EFF(4),e.nI1(5,"translate"),e.k0s()()(),e.j41(6,"nb-card",2)(7,"div",3),e.nrm(8,"br")(9,"br"),e.j41(10,"button",4),e.bIt("click",function(){return n.ShowAdd()}),e.EFF(11),e.nI1(12,"translate"),e.k0s()(),e.j41(13,"table",5),e.bIt("matSortChange",function(o){return n.sortData(o)}),e.qex(14,6),e.DNE(15,Ve,3,3,"th",7),e.DNE(16,We,4,2,"td",8),e.bVm(),e.qex(17,9),e.DNE(18,He,1,0,"th",10),e.DNE(19,qe,4,2,"td",8),e.bVm(),e.DNE(20,Qe,1,0,"tr",11),e.DNE(21,Ke,1,0,"tr",12),e.k0s()(),e.j41(22,"mat-paginator",13),e.bIt("page",function(o){return n.search(o)}),e.k0s()()),2&t&&(e.R7$(4),e.SpI(" ",e.bMT(5,11,"Roles"),""),e.R7$(6),e.Y8G("hidden",!n.canAdd),e.R7$(1),e.SpI(" ",e.bMT(12,13,"Add")," "),e.R7$(2),e.Y8G("dataSource",n.dataSource),e.R7$(7),e.Y8G("matHeaderRowDef",n.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",n.displayedColumns),e.R7$(1),e.Y8G("dir",n.dir)("length",n.totalRecords)("pageIndex",n.searchModel.PageNumber-1)("pageSize",n.searchModel.PageSize)("pageSizeOptions",n.pageSizeOptions))},dependencies:[d.SrT,d.zJv,d.i6h,C.bT,P.An,E.ig,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,u.B4,u.aE,_.iy,m.D9],styles:[".table-container[_ngcontent-%COMP%]{border-radius:2rem;overflow-x:scroll;overflow-y:auto}table[_ngcontent-%COMP%]{width:20rem}.search-container[_ngcontent-%COMP%]{margin:1rem auto;display:flex;justify-content:center}.col-md-4[_ngcontent-%COMP%], .col-md-6[_ngcontent-%COMP%], .col-md-12[_ngcontent-%COMP%]{padding:5px!important}.users-table[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;border-collapse:collapse}tr[_ngcontent-%COMP%]{height:3.2rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center!important;padding:10px}th[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1.3rem}  .mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0;justify-content:center}"]})}}return s})()},{path:"add",component:le},{path:"edit/:id",component:$e},{path:"Permissions/:id",component:T},{path:"Permissions",component:T}];let tt=(()=>{class s{static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[g.iI.forChild(et),g.iI]})}}return s})(),it=(()=>{class s{static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[tt,d.lVF,d.P5N,d.pty,C.MD,p.YN,p.X1,d.dQU,d.lVF,d.P5N,d._A2,d.NeG,d.clu,d.VcP,P.m_,c.tP,u.NQ,_.Ou,$.G,m.h.forChild({loader:{provide:m.Wr,useFactory:N._,deps:[G.Qq]}})]})}}return s})()}}]);