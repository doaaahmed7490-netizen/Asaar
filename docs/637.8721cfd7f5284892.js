"use strict";(self.webpackChunknebular_downgrade_2=self.webpackChunknebular_downgrade_2||[]).push([[637],{9637:(gt,R,d)=>{d.r(R),d.d(R,{UserModule:()=>_t});var b=d(177),a=d(9417),c=d(4069),m=d(7037),h=d(3955),y=d(1322),U=d(1626),S=d(9615),T=d(9213),F=d(2042),f=d(5743),g=d(6962),e=d(7705),j=d(3878),p=d(2113);const G=localStorage.getItem("token");let _=(new U.Lr).set("Authorization","Bearer "+G),N=(()=>{class t{constructor(r){this.http=r}create(r){return this.http.post("http://localhost:5043/api/LettersTypes/CreateLetterType",r,{headers:_})}addUser(r){return this.http.post(p.K.baseUrl+p.K.User.add,r,{headers:_})}searchUsers(r){return this.http.post(p.K.baseUrl+p.K.User.list,r)}getUserId(r){return this.http.post(p.K.baseUrl+p.K.User.getById,{Id:r},{headers:_})}deleteUser(r){return this.http.post(p.K.baseUrl+p.K.User.archive,{Id:r},{headers:_})}ActivateUser(r){return this.http.post(p.K.baseUrl+p.K.User.activate,{Id:r},{headers:_})}DeActivateUser(r){return this.http.post(p.K.baseUrl+p.K.User.deactivate,{Id:r},{headers:_})}updateUser(r){return this.http.post(p.K.baseUrl+p.K.User.edit,r,{headers:_})}static{this.\u0275fac=function(o){return new(o||t)(e.KVO(U.Qq))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var C=d(2741),v=d(4866);function D(t,s){if(1&t&&(e.j41(0,"nb-option",36),e.EFF(1),e.k0s()),2&t){const r=s.$implicit;e.Y8G("value",r.id),e.R7$(1),e.SpI(" ",r.name,"")}}function w(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Name is required")," "))}function L(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Name pattern")," "))}function Y(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"min length 3 Letters")," "))}function P(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"User Name is required")," "))}function A(t,s){if(1&t){const r=e.RV6();e.j41(0,"button",37),e.bIt("click",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.TogglePassword())}),e.nrm(1,"nb-icon",38),e.k0s()}}function V(t,s){if(1&t){const r=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.TogglePassword())}),e.nrm(1,"nb-icon",40),e.k0s()}}function B(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Password must be at least 8 characters")," "))}function X(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Password must contain at least 1 Upper case, 1 lower case and a number")," "))}function O(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Password is Required")," "))}function x(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"NationalId pattern")," "))}function W(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"NationalId min length")," "))}function z(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"NationalId max length")," "))}function q(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"NationalId not contain negative number")," "))}function J(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil pattern")," "))}function K(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil not contain negative number")," "))}function H(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil min length")," "))}function Z(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil max length")," "))}function Q(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone pattern")," "))}function ee(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone min length")," "))}function te(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone max length")," "))}function ne(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone not contain negative number")," "))}function re(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Email pattern")," "))}function oe(t,s){if(1&t&&(e.j41(0,"nb-option",36),e.EFF(1),e.k0s()),2&t){const r=s.$implicit;e.Y8G("value",r.id),e.R7$(1),e.SpI(" ",r.roleName,"")}}let se=(()=>{class t{constructor(r,o,n,i,l,u,I,E){this.formBuilder=r,this.empService=o,this.userService=n,this.router=i,this.route=l,this.toastrService=u,this.translate=I,this.roleService=E,this.userModel=[],this.submitted=!1,this.isSubmitted=!1,this.showPass=!1,this.roleModel=[],this.Employees=[],this.IsEmp=!1,(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth")}ngOnInit(){this.initForm(),this.getEmployees(),this.getRoles()}getEmployees(){this.empService.searchEmployees({PageNumber:1,PageSize:1e3}).subscribe(r=>{this.Employees=r.entity.entities,console.log("Employees "+this.Employees)})}getRoles(){this.roleService.ListRoles({PageNumber:1,PageSize:1e3}).subscribe(r=>{this.roleModel=r.entity.entities})}initForm(){this.userForm=this.formBuilder.group({userName:["",[a.k0.required,a.k0.minLength(3)]],name:["",[a.k0.required,a.k0.minLength(3),a.k0.pattern("^[a-zA-Z\u0621-\u064as]*$")]],password:["",[a.k0.required,a.k0.minLength(8),a.k0.pattern("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$")]],nationalId:[null,[a.k0.pattern("^[0-9]*$"),a.k0.minLength(10),a.k0.min(0),a.k0.maxLength(10)]],phoneNumber:[null,[a.k0.pattern("^[0-9]*$"),a.k0.minLength(10),a.k0.min(0),a.k0.maxLength(10)]],mobil:[null,[a.k0.pattern("^[0-9]*$"),a.k0.minLength(10),a.k0.min(0),a.k0.maxLength(12)]],gender:[null],email:["",[a.k0.email]],empId:[null],roleId:[null,[a.k0.required]]})}selectChangeHandlerEmp(r){this.EmpId=r,this.IsEmp=!0,console.log("Job= "+this.EmpId),console.log("Emp Staty "+this.IsEmp),this.getEmpInfoById()}selectChangeHandlerGender(r){this.genderValue=r.target.value}getEmpInfoById(){this.empService.getById(this.EmpId).subscribe(r=>{this.currentEmp=r.entity,console.log("CurrentEmp= "+this.currentEmp),this.bindForm()})}bindForm(){this.userForm.controls.empId.setValue(this.currentEmp.id),this.userForm.controls.name.setValue(this.currentEmp.name),this.userForm.controls.nationalId.setValue(this.currentEmp.nationalId),this.userForm.controls.mobil.setValue(this.currentEmp.mobil),this.userForm.controls.phoneNumber.setValue(this.currentEmp.phone),this.userForm.controls.email.setValue(this.currentEmp.email)}onSubmit(){console.log("Hellooooooooo"),this.submitted=!0,this.isSubmitted=!0;const r=this.userForm.value;let o={name:r.name,userName:r.userName,nationalId:r.nationalId,phoneNo:r.phoneNumber,email:r.email,mobil:r.mobil,password:r.password,gender:!0,employeeId:r.empId,roleId:r.roleId};o.gender=1==this.genderValue,""==r.email&&(o.email=null);const n=i=>!/\S/.test(i);1==n(o.userName)||1==n(o.name)||1==n(o.password)?this.toastrService.danger("\u064a\u062c\u0628 \u0625\u0633\u062a\u0643\u0645\u0627\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0625\u062a\u0645\u0627\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062d\u0641\u0638","\u062e\u0637\u0623"):this.userService.addUser(o).subscribe({next:i=>{this.toastrService.Create(g.C.User),this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Users")},error:i=>{this.toastrService.danger(i.error.error,"\u062e\u0637\u0623"),this.submitted=!1,this.isSubmitted=!1}})}TogglePassword(){var r=document.getElementById("password");"password"===r.type?(r.type="text",this.showPass=!0):(r.type="password",this.showPass=!1)}get fc(){return this.userForm.controls}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(a.ok),e.rXU(j.O),e.rXU(N),e.rXU(f.Ix),e.rXU(f.nX),e.rXU(C.t),e.rXU(h.c$),e.rXU(v.W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-add-user"]],decls:115,vars:75,consts:[[1,"content-container","mt-5"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-6"],[1,"form-group"],["for","Employee",1,"label"],["shape","round","fullWidth","","formControlName","empId","id","empId",3,"selectedChange"],[3,"value",4,"ngFor","ngForOf"],["for","Name",1,"label"],["type","text","formControlName","name","nbInput","","shape","round","fullWidth","","id","name",3,"readonly"],[4,"ngIf"],[1,"form-group","mt-2"],["for","username",1,"label"],["type","text","formControlName","userName","nbInput","","shape","round","fullWidth","","id","userName",3,"status"],["for","Password",1,"label"],["autocomplete","new-password","type","password","formControlName","password","nbInput","","shape","round","fullWidth","","id","password",3,"status"],["title","hide password","type","button","class","p_btn","nbSuffix","","nbButton","",3,"click",4,"ngIf"],["title","show password","type","button","class","p_btn","nbSuffix","","nbButton","",3,"click",4,"ngIf"],["for","NationalId",1,"label"],["type","text","placeholder","Ex:1570572194","formControlName","nationalId","nbInput","","shape","round","fullWidth","","id","nationalId","minlength","10","maxlength","10",3,"readonly"],["for","Mobil",1,"label"],["type","text","inputmode","numeric","pattern","[-+]?[0-9]*[.,]?[0-9]+","formControlName","mobil","nbInput","","shape","round","fullWidth","","id","mobil","minlength","10","maxlength","12","placeholder","Ex: 966564801391",3,"readonly","status"],["for","PhoneNumber",1,"label"],["type","text","inputmode","numeric","pattern","[-+]?[0-9]*[.,]?[0-9]+","placeholder","Ex: 0125985301","formControlName","phoneNumber","nbInput","","shape","round","fullWidth","","id","phoneNumber","minlength","10","maxlength","10",3,"readonly"],["for","Email",1,"label"],["type","text","placeholder","Ex: dmostafa@jeddah.gov.sa","formControlName","email","nbInput","","shape","round","fullWidth","","id","email",3,"readonly"],["for","Gender",1,"label"],["id","gender","formControlName","gender",1,"form-control",3,"change"],["value","1"],["value","2"],["for","Role",1,"label"],["formControlName","roleId","id","roleId","shape","round","fullWidth",""],["value",""],[1,"row","mt-2"],[1,"col-md-2"],["type","submit",1,"special-button","m-2","mt-4","w-100"],[3,"value"],["title","hide password","type","button","nbSuffix","","nbButton","",1,"p_btn",3,"click"],["pack","eva","icon","eye-outline"],["title","show password","type","button","nbSuffix","","nbButton","",1,"p_btn",3,"click"],["pack","eva","icon","eye-off-outline"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"h5"),e.EFF(2),e.nI1(3,"translate"),e.nI1(4,"translate"),e.k0s(),e.nrm(5,"hr"),e.j41(6,"form",1),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(7,"div",2)(8,"div",3)(9,"div",4)(10,"label",5)(11,"h6"),e.EFF(12),e.nI1(13,"translate"),e.k0s()(),e.j41(14,"nb-select",6),e.bIt("selectedChange",function(l){return n.selectChangeHandlerEmp(l)}),e.DNE(15,D,2,2,"nb-option",7),e.k0s()()(),e.j41(16,"div",3)(17,"div",4)(18,"label",8)(19,"h6"),e.EFF(20),e.nI1(21,"translate"),e.k0s()(),e.nrm(22,"input",9),e.DNE(23,w,3,3,"mat-error",10),e.DNE(24,L,3,3,"mat-error",10),e.DNE(25,Y,3,3,"mat-error",10),e.k0s()(),e.j41(26,"div",3)(27,"div",11)(28,"label",12)(29,"h6"),e.EFF(30),e.nI1(31,"translate"),e.k0s()(),e.nrm(32,"input",13),e.DNE(33,P,3,3,"mat-error",10),e.k0s()(),e.j41(34,"div",3)(35,"div",11)(36,"label",14)(37,"h6"),e.EFF(38),e.nI1(39,"translate"),e.k0s()(),e.j41(40,"nb-form-field"),e.nrm(41,"input",15),e.DNE(42,A,2,0,"button",16),e.DNE(43,V,2,0,"button",17),e.k0s(),e.DNE(44,B,3,3,"mat-error",10),e.DNE(45,X,3,3,"mat-error",10),e.DNE(46,O,3,3,"mat-error",10),e.k0s()(),e.j41(47,"div",3)(48,"div",11)(49,"label",18)(50,"h6"),e.EFF(51),e.nI1(52,"translate"),e.k0s()(),e.nrm(53,"input",19),e.DNE(54,x,3,3,"mat-error",10),e.DNE(55,W,3,3,"mat-error",10),e.DNE(56,z,3,3,"mat-error",10),e.DNE(57,q,3,3,"mat-error",10),e.k0s()(),e.j41(58,"div",3)(59,"div",11)(60,"label",20)(61,"h6"),e.EFF(62),e.nI1(63,"translate"),e.k0s()(),e.nrm(64,"input",21),e.DNE(65,J,3,3,"mat-error",10),e.DNE(66,K,3,3,"mat-error",10),e.DNE(67,H,3,3,"mat-error",10),e.DNE(68,Z,3,3,"mat-error",10),e.k0s()(),e.j41(69,"div",3)(70,"div",11)(71,"label",22)(72,"h6"),e.EFF(73),e.nI1(74,"translate"),e.k0s()(),e.nrm(75,"input",23),e.DNE(76,Q,3,3,"mat-error",10),e.DNE(77,ee,3,3,"mat-error",10),e.DNE(78,te,3,3,"mat-error",10),e.DNE(79,ne,3,3,"mat-error",10),e.k0s()(),e.j41(80,"div",3)(81,"div",11)(82,"label",24)(83,"h6"),e.EFF(84),e.nI1(85,"translate"),e.k0s()(),e.nrm(86,"input",25),e.DNE(87,re,3,3,"mat-error",10),e.k0s()(),e.j41(88,"div",3)(89,"div",11)(90,"label",26)(91,"h6"),e.EFF(92),e.nI1(93,"translate"),e.k0s()(),e.j41(94,"select",27),e.bIt("change",function(l){return n.selectChangeHandlerGender(l)}),e.j41(95,"option",28),e.EFF(96,"\u0630\u0643\u0631"),e.k0s(),e.j41(97,"option",29),e.EFF(98,"\u0627\u0646\u062b\u0649"),e.k0s()()()(),e.j41(99,"div",3)(100,"div",11)(101,"label",30)(102,"h6"),e.EFF(103),e.nI1(104,"translate"),e.k0s()(),e.j41(105,"nb-select",31)(106,"nb-option",32),e.EFF(107),e.nI1(108,"translate"),e.k0s(),e.DNE(109,oe,2,2,"nb-option",7),e.k0s()()()(),e.j41(110,"div",33)(111,"div",34)(112,"button",35),e.EFF(113),e.nI1(114,"translate"),e.k0s()()()()()),2&o&&(e.R7$(2),e.Lme("",e.bMT(3,47,"Add")," ",e.bMT(4,49,"User")," "),e.R7$(4),e.Y8G("formGroup",n.userForm),e.R7$(6),e.SpI(" ",e.bMT(13,51,"Employee")," "),e.R7$(3),e.Y8G("ngForOf",n.Employees),e.R7$(5),e.SpI(" ",e.bMT(21,53,"Name")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp),e.R7$(1),e.Y8G("ngIf",n.fc.name.touched&&n.fc.name.hasError("required")),e.R7$(1),e.Y8G("ngIf",n.fc.name.touched&&n.fc.name.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.name.touched&&n.fc.name.hasError("minlength")&&!n.fc.name.hasError("required")&&!n.fc.name.hasError("pattern")),e.R7$(5),e.SpI(" ",e.bMT(31,55,"username")," "),e.R7$(2),e.Y8G("status",n.fc.userName.touched&&n.fc.userName.errors?"danger":"basic"),e.R7$(1),e.Y8G("ngIf",n.fc.userName.touched&&n.fc.userName.hasError("required")),e.R7$(5),e.SpI(" ",e.bMT(39,57,"password")," "),e.R7$(3),e.Y8G("status",n.fc.password.touched&&n.fc.password.errors?"danger":"basic"),e.R7$(1),e.Y8G("ngIf",!n.showPass),e.R7$(1),e.Y8G("ngIf",n.showPass),e.R7$(1),e.Y8G("ngIf",n.fc.password.touched&&n.fc.password.hasError("minlength")&&!n.fc.password.hasError("required")),e.R7$(1),e.Y8G("ngIf",n.fc.password.touched&&n.fc.password.hasError("pattern")&&!n.fc.password.hasError("required")),e.R7$(1),e.Y8G("ngIf",n.fc.password.touched&&n.fc.password.hasError("required")),e.R7$(5),e.SpI(" ",e.bMT(52,59,"NationalId")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp),e.R7$(1),e.Y8G("ngIf",n.fc.nationalId.touched&&n.fc.nationalId.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.nationalId.touched&&n.fc.nationalId.hasError("minlength")&&!n.fc.nationalId.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.nationalId.touched&&n.fc.nationalId.hasError("maxlength")&&!n.fc.nationalId.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.nationalId.touched&&n.fc.nationalId.hasError("min")),e.R7$(5),e.SpI(" ",e.bMT(63,61,"Mobil")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp)("status",n.fc.mobil.touched&&n.fc.mobil.errors?"danger":"basic"),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("min")),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("minlength")&&!n.fc.mobil.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("maxlength")&&!n.fc.mobil.hasError("pattern")),e.R7$(5),e.SpI(" ",e.bMT(74,63,"Phone")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("minlength")&&!n.fc.phoneNumber.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("maxlength")&&!n.fc.phoneNumber.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("min")),e.R7$(5),e.SpI(" ",e.bMT(85,65,"Email")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp),e.R7$(1),e.Y8G("ngIf",n.fc.email.touched&&n.fc.email.hasError("email")),e.R7$(5),e.JRh(e.bMT(93,67,"Gender")),e.R7$(11),e.SpI(" ",e.bMT(104,69,"Role")," "),e.R7$(4),e.JRh(e.bMT(108,71,"No data selected")),e.R7$(2),e.Y8G("ngForOf",n.roleModel),e.R7$(4),e.SpI(" ",e.bMT(114,73,"Save")," "))},dependencies:[m.YP2,m.i6h,b.Sq,b.bT,a.qT,a.xH,a.y7,a.me,a.wz,a.BC,a.cb,a.xh,a.tU,a.R_,a.j4,a.JD,m.u_9,m.zb0,m.tHu,m.S81,m.ZJ2,h.D9]})}}return t})();function ae(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Name is required")," "))}function ie(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Name pattern")," "))}function le(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"min length 3 Letters")," "))}function me(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil is required")," "))}function de(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil pattern")," "))}function pe(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil min length")," "))}function ce(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil not contain negative number")," "))}function ue(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone pattern")," "))}function he(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone min length")," "))}function fe(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone not contain negative number")," "))}function _e(t,s){1&t&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Email pattern")," "))}function be(t,s){if(1&t&&(e.j41(0,"nb-option",28),e.EFF(1),e.k0s()),2&t){const r=s.$implicit;e.Y8G("value",r.id),e.R7$(1),e.SpI(" ",r.roleName,"")}}let ge=(()=>{class t{constructor(r,o,n,i,l,u,I){this.formBuilder=r,this.userService=o,this.router=n,this.route=i,this.toastrService=l,this.translate=u,this.roleService=I,this.userModel=[],this.roleModel=[],this.submitted=!1,this.isSubmitted=!1,this.showPass=!1,(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth")}ngOnInit(){this.initForm(),this.route.params.subscribe(r=>{this.Id=r.id}),this.getUserInfoById(),this.getRoles()}getRoles(){this.roleService.ListRoles({PageNumber:1,PageSize:1e3}).subscribe(r=>{this.roleModel=r.entity.entities})}initForm(){this.userForm=this.formBuilder.group({id:[""],name:["",[a.k0.required,a.k0.minLength(3),a.k0.pattern("^[a-zA-Z\u0621-\u064as]*$")]],nationalId:[null,[a.k0.pattern("^[0-9]*$")]],phoneNumber:[null,[a.k0.pattern("^[0-9]*$"),a.k0.min(0),a.k0.minLength(10)]],mobil:[null,[a.k0.required,a.k0.pattern("^[0-9]*$"),a.k0.minLength(10),a.k0.min(0)]],gender:[null],email:["",[a.k0.email]],roleId:[null,[a.k0.required]]})}getUserInfoById(){this.userService.getUserId(this.Id).subscribe(r=>{this.currentUser=r.entity,this.bindForm()})}bindForm(){this.userForm.controls.id.setValue(this.currentUser.id),this.userForm.controls.name.setValue(this.currentUser.name),this.userForm.controls.nationalId.setValue(this.currentUser.nationalId),this.userForm.controls.phoneNumber.setValue(this.currentUser.phoneNo),this.userForm.controls.mobil.setValue(this.currentUser.mobil),this.userForm.controls.email.setValue(this.currentUser.email),this.userForm.controls.gender.setValue(this.currentUser.gender),this.gender=this.currentUser.gender,this.userForm.controls.roleId.setValue(this.currentUser.roleId),this.roleId=this.currentUser.roleId,console.log("RoleId= "+this.roleId),this.GenderVal=1==this.currentUser.gender,null!=this.currentUser.employeeId&&(this.IsEmp=!0)}onSubmit(){this.submitted=!0,this.isSubmitted=!0;const r=this.userForm.value;let o={id:this.Id,name:r.name,userName:r.userName,nationalId:r.nationalId,phoneNumber:r.phoneNumber,email:r.email,mobil:r.mobil,password:r.password,gender:this.GenderVal,roleId:r.roleId};o.id=this.Id;const n=i=>!/\S/.test(i);1==n(o.userName)||1==n(o.name)||1==n(o.password)?this.toastrService.danger("\u064a\u062c\u0628 \u0625\u0633\u062a\u0643\u0645\u0627\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0625\u062a\u0645\u0627\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062d\u0641\u0638","\u062e\u0637\u0623"):this.userService.updateUser(o).subscribe({next:i=>{this.toastrService.Update(g.C.User),this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Users")},error:i=>{this.toastrService.danger(i.error.error,"\u062e\u0637\u0623"),this.submitted=!1,this.isSubmitted=!1}})}TogglePassword(){var r=document.getElementById("password");"password"===r.type?(r.type="text",this.showPass=!0):(r.type="password",this.showPass=!1)}get fc(){return this.userForm.controls}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(a.ok),e.rXU(N),e.rXU(f.Ix),e.rXU(f.nX),e.rXU(C.t),e.rXU(h.c$),e.rXU(v.W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-edit-user"]],decls:78,vars:52,consts:[[1,"content-container","mt-5"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-sm-6"],[1,"form-group"],["for","Name",1,"label"],["type","text","formControlName","name","nbInput","","shape","round","fullWidth","","id","name","placeholder","Ex: John",3,"readonly","status"],[4,"ngIf"],["for","NationalId",1,"label"],["type","number","inputmode","numeric","pattern","[-+]?[0-9]*[.,]?[0-9]+","maxlength","10","placeholder","Ex:1570572194","formControlName","nationalId","nbInput","","shape","round","fullWidth","","id","nationalId",3,"readonly"],[1,"form-group","mt-2"],["for","Mobil",1,"label"],["type","text","inputmode","numeric","pattern","[-+]?[0-9]*[.,]?[0-9]+","formControlName","mobil","nbInput","","shape","round","fullWidth","","id","mobil","placeholder","Ex:966564801391",3,"readonly","status"],["for","PhoneNumber",1,"label"],["type","text","placeholder","Ex:0125985301","formControlName","phoneNumber","nbInput","","shape","round","fullWidth","","id","phoneNumber",3,"readonly"],["for","Email",1,"label"],["type","text","placeholder","Ex:dmostafa@jeddah.gov.sa","formControlName","email","nbInput","","shape","round","fullWidth","","id","email"],[1,"col-sm-6",3,"hidden"],["for","Gender",1,"label"],["id","gender","formControlName","gender",1,"form-control",3,"ngModel","ngModelChange"],["value","1"],["value","2"],["for","Role",1,"label"],["formControlName","roleId","id","roleId","shape","round","fullWidth",""],[3,"value",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"col-md-2"],["type","submit",1,"special-button","m-2","mt-4","w-100",3,"disabled"],[3,"value"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"h5"),e.EFF(2),e.nI1(3,"translate"),e.nI1(4,"translate"),e.k0s(),e.nrm(5,"hr"),e.j41(6,"form",1),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(7,"div",2)(8,"div",3)(9,"div",4)(10,"label",5)(11,"h6"),e.EFF(12),e.nI1(13,"translate"),e.k0s()(),e.nrm(14,"input",6),e.DNE(15,ae,3,3,"mat-error",7),e.DNE(16,ie,3,3,"mat-error",7),e.DNE(17,le,3,3,"mat-error",7),e.k0s()(),e.j41(18,"div",3)(19,"div",4)(20,"label",8)(21,"h6"),e.EFF(22),e.nI1(23,"translate"),e.k0s()(),e.nrm(24,"input",9),e.k0s()(),e.j41(25,"div",3)(26,"div",10)(27,"label",11)(28,"h6"),e.EFF(29),e.nI1(30,"translate"),e.k0s()(),e.nrm(31,"input",12),e.DNE(32,me,3,3,"mat-error",7),e.DNE(33,de,3,3,"mat-error",7),e.DNE(34,pe,3,3,"mat-error",7),e.DNE(35,ce,3,3,"mat-error",7),e.k0s()(),e.j41(36,"div",3)(37,"div",10)(38,"label",13)(39,"h6"),e.EFF(40),e.nI1(41,"translate"),e.k0s()(),e.nrm(42,"input",14),e.DNE(43,ue,3,3,"mat-error",7),e.DNE(44,he,3,3,"mat-error",7),e.DNE(45,fe,3,3,"mat-error",7),e.k0s()(),e.j41(46,"div",3)(47,"div",10)(48,"label",15)(49,"h6"),e.EFF(50),e.nI1(51,"translate"),e.k0s()(),e.nrm(52,"input",16),e.DNE(53,_e,3,3,"mat-error",7),e.k0s()(),e.j41(54,"div",17)(55,"div",10)(56,"label",18)(57,"h6"),e.EFF(58),e.nI1(59,"translate"),e.k0s()(),e.j41(60,"select",19),e.bIt("ngModelChange",function(l){return n.gender=l}),e.j41(61,"option",20),e.EFF(62,"\u0630\u0643\u0631"),e.k0s(),e.j41(63,"option",21),e.EFF(64,"\u0627\u0646\u062b\u0649"),e.k0s()()()(),e.j41(65,"div",3)(66,"div",10)(67,"label",22)(68,"h6"),e.EFF(69),e.nI1(70,"translate"),e.k0s()(),e.j41(71,"nb-select",23),e.DNE(72,be,2,2,"nb-option",24),e.k0s()()()(),e.j41(73,"div",25)(74,"div",26)(75,"button",27),e.EFF(76),e.nI1(77,"translate"),e.k0s()()()()()),2&o&&(e.R7$(2),e.Lme("",e.bMT(3,32,"Edit")," ",e.bMT(4,34,"User")," "),e.R7$(4),e.Y8G("formGroup",n.userForm),e.R7$(6),e.SpI(" ",e.bMT(13,36,"Name")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp)("status",n.fc.name.touched&&n.fc.name.errors?"danger":"basic"),e.R7$(1),e.Y8G("ngIf",n.fc.name.touched&&n.fc.name.hasError("required")),e.R7$(1),e.Y8G("ngIf",n.fc.name.touched&&n.fc.name.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.name.touched&&n.fc.name.hasError("minlength")&&!n.fc.name.hasError("required")&&!n.fc.name.hasError("pattern")),e.R7$(5),e.SpI(" ",e.bMT(23,38,"NationalId")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp),e.R7$(5),e.SpI(" ",e.bMT(30,40,"Mobil")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp)("status",n.fc.mobil.touched&&n.fc.mobil.errors?"danger":"basic"),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("required")),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("minlength")&&!n.fc.mobil.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.mobil.touched&&n.fc.mobil.hasError("min")),e.R7$(5),e.SpI(" ",e.bMT(41,42,"Phone")," "),e.R7$(2),e.Y8G("readonly",n.IsEmp),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("minlength")&&!n.fc.phoneNumber.hasError("pattern")),e.R7$(1),e.Y8G("ngIf",n.fc.phoneNumber.touched&&n.fc.phoneNumber.hasError("min")),e.R7$(5),e.SpI(" ",e.bMT(51,44,"Email")," "),e.R7$(3),e.Y8G("ngIf",n.fc.email.touched&&n.fc.email.hasError("email")),e.R7$(1),e.Y8G("hidden",!0),e.R7$(4),e.JRh(e.bMT(59,46,"Gender")),e.R7$(2),e.Y8G("ngModel",n.gender),e.R7$(9),e.SpI(" ",e.bMT(70,48,"Role")," "),e.R7$(3),e.Y8G("ngForOf",n.roleModel),e.R7$(3),e.Y8G("disabled",n.isSubmitted),e.R7$(1),e.SpI(" ",e.bMT(77,50,"Save")," "))},dependencies:[m.i6h,b.Sq,b.bT,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.tU,a.R_,a.j4,a.JD,m.S81,m.ZJ2,h.D9]})}}return t})();var $=d(467),k=d(5312),Ie=d(6952),Ee=d(8203);const Fe=["nameFilter"],Ce=["emailFilter"],Ue=["roleFilter"];function Se(t,s){1&t&&(e.j41(0,"th",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Name")," "))}function Ne(t,s){if(1&t){const r=e.RV6();e.j41(0,"span")(1,"input",24,25),e.bIt("keyup",function(n){e.eBV(r);const i=e.XpG(2);return e.Njj(i.applyFilter(n))}),e.nI1(3,"translate"),e.k0s()()}2&t&&(e.R7$(1),e.Y8G("placeholder",e.bMT(3,1,"User")))}function ve(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.JRh(r.name)}}function Re(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,Ne,4,3,"span",22),e.DNE(2,ve,2,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.name)("ngIfElse",o)}}function Te(t,s){1&t&&(e.j41(0,"th",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Role")," "))}function $e(t,s){if(1&t){const r=e.RV6();e.j41(0,"span")(1,"input",24,26),e.bIt("keyup",function(n){e.eBV(r);const i=e.XpG(2);return e.Njj(i.applyFilter(n))}),e.nI1(3,"translate"),e.k0s()()}2&t&&(e.R7$(1),e.Y8G("placeholder",e.bMT(3,1,"Role")))}function ke(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.JRh(r.roleName)}}function ye(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,$e,4,3,"span",22),e.DNE(2,ke,2,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.roleName)("ngIfElse",o)}}function je(t,s){1&t&&(e.j41(0,"th",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"NationalId")," "))}function Me(t,s){1&t&&e.nrm(0,"span")}function Ge(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.JRh(r.nationalId)}}function De(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,Me,1,0,"span",22),e.DNE(2,Ge,2,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.name)("ngIfElse",o)}}function we(t,s){1&t&&(e.j41(0,"th",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Phone")," "))}function Le(t,s){1&t&&e.nrm(0,"span")}function Ye(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.JRh(r.phoneNo)}}function Pe(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,Le,1,0,"span",22),e.DNE(2,Ye,2,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.name)("ngIfElse",o)}}function Ae(t,s){1&t&&(e.j41(0,"th",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Mobil")," "))}function Ve(t,s){1&t&&e.nrm(0,"span")}function Be(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.JRh(r.mobil)}}function Xe(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,Ve,1,0,"span",22),e.DNE(2,Be,2,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.name)("ngIfElse",o)}}function Oe(t,s){1&t&&(e.j41(0,"th",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"Email")," "))}function xe(t,s){1&t&&e.nrm(0,"span")}function We(t,s){if(1&t&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.JRh(r.email)}}function ze(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,xe,1,0,"span",22),e.DNE(2,We,2,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.email)("ngIfElse",o)}}function qe(t,s){1&t&&(e.j41(0,"th",27),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.JRh(e.bMT(2,1,"Activate")))}function Je(t,s){1&t&&e.nrm(0,"span")}function Ke(t,s){if(1&t){const r=e.RV6();e.j41(0,"nb-toggle",28),e.bIt("ngModelChange",function(n){e.eBV(r);const i=e.XpG().$implicit;return e.Njj(i.isActive=n)})("change",function(){e.eBV(r);const n=e.XpG().$implicit,i=e.XpG();return e.Njj(i.onToggleChange(n,i.dialog))}),e.k0s()}if(2&t){const r=e.XpG().$implicit;e.Y8G("ngModel",r.isActive)}}function He(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,Je,1,0,"span",22),e.DNE(2,Ke,1,1,"ng-template",null,23,e.C5r),e.nrm(4,"nb-card"),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",""==r.name)("ngIfElse",o)}}function Ze(t,s){1&t&&(e.j41(0,"th",27),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"DeActivate")," "))}function Qe(t,s){if(1&t){const r=e.RV6();e.j41(0,"td",21)(1,"button",29),e.bIt("click",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.deacivate(n.ref))}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}2&t&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"Deactivate")," "))}function et(t,s){1&t&&e.nrm(0,"th",27)}function tt(t,s){1&t&&e.nrm(0,"span")}function nt(t,s){if(1&t){const r=e.RV6();e.j41(0,"span")(1,"button",30),e.bIt("click",function(){e.eBV(r);const n=e.XpG().$implicit,i=e.XpG();return e.Njj(i.ShowEdit(n.id))}),e.j41(2,"mat-icon"),e.EFF(3,"edit"),e.k0s()()()}if(2&t){const r=e.XpG(2);e.R7$(1),e.Y8G("hidden",!r.canEdit)}}function rt(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,tt,1,0,"span",22),e.DNE(2,nt,4,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",0==r.sortable)("ngIfElse",o)}}function ot(t,s){1&t&&e.nrm(0,"th",27)}function st(t,s){1&t&&e.nrm(0,"span")}function at(t,s){if(1&t){const r=e.RV6();e.j41(0,"span")(1,"button",31),e.bIt("click",function(){e.eBV(r);const n=e.XpG().$implicit,i=e.XpG();return e.Njj(i.delete(n.id,n.name))}),e.j41(2,"mat-icon"),e.EFF(3,"delete"),e.k0s()()()}if(2&t){const r=e.XpG(2);e.R7$(1),e.Y8G("hidden",!r.canDelete)}}function it(t,s){if(1&t&&(e.j41(0,"td",21),e.DNE(1,st,1,0,"span",22),e.DNE(2,at,4,1,"ng-template",null,23,e.C5r),e.k0s()),2&t){const r=s.$implicit,o=e.sdS(3);e.R7$(1),e.Y8G("ngIf",0==r.sortable)("ngIfElse",o)}}function lt(t,s){1&t&&e.nrm(0,"tr",32)}function mt(t,s){1&t&&e.nrm(0,"tr",33)}const dt=[{path:"",component:(()=>{class t{constructor(r,o,n,i,l,u,I,E,bt){this.toastrService=r,this.translate=o,this.userService=n,this.router=i,this.route=l,this._detector=u,this.dialogService=I,this.toastr=E,this.roleService=bt,this.dir="ltr",this.active=!0,this.totalRecords=0,this.pageSizeOptions=k.c.DEFAULT_PAGE_SIZE_OPTIONS,this.displayedColumns=["Name","Role","Mobil","Phone","Email","actions","actions1","Activate"],this.user=[],(null==localStorage.getItem("token")||""==localStorage.getItem("token"))&&this.router.navigateByUrl("/auth"),"ar"==o.currentLang&&(this.dir="rtl")}ngOnInit(){this.searchModel={PageNumber:1,PageSize:k.c.DEFAULT_PAGE_SIZE},this.search(),this._detector.markForCheck(),this.roleService.getActionByRoleId(localStorage.getItem("RoleId"),"User").subscribe(r=>{this.canAdd=r.entity.add,this.canEdit=r.entity.update,this.canDelete=r.entity.delete})}ngAfterViewInit(){this.dataSource.sort=this.sort}sortData(r){const o=this.dataSource.data.slice();r.active&&""!==r.direction?(this.dataSource.data=o.sort((n,i)=>{if(!n.sortable||!i.sortable)return 1;{let l="asc"===r.direction;switch(r.active){case"Name":return this.compare(n.name.toLowerCase(),i.name.toLowerCase(),l);case"Role":return this.compare(n.roleName.toLowerCase(),i.roleName.toLowerCase(),l);case"Mobil":return this.compare(n.mobil,i.mobil,l);case"Phone":return this.compare(n.phoneNo,i.phoneNo,l);case"Email":return this.compare(n.email.toLowerCase(),i.email.toLowerCase(),l);case"nationalId":return this.compare(n.nationalId,i.nationalId,l);default:return 0}}}),this.dataSource=new c.I6(this.dataSource.data)):this.dataSource.data=o}compare(r,o,n){return r<o?-1*(n?1:-1):r>o?1*(n?1:-1):0*(n?1:-1)}applyFilter(r){const o={name:this.nameFilter.nativeElement.value.trim(),roleName:this.roleFilter.nativeElement.value.trim(),sortable:!0};this.dataSource.filterPredicate=(n,i)=>{const l=JSON.parse(i);return""==n.name&&""==n.roleName||n.name.toLowerCase().includes(l.name.toLowerCase())&&n.roleName.toLowerCase().includes(l.roleName.toLowerCase())},this.dataSource.filter=JSON.stringify(o),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}deacivate(r){var o=this;return(0,$.A)(function*(){o.userService.DeActivateUser(o.userId).subscribe(n=>{r.close(),o.toastr.Deactivate(g.C.User),o.search()})})()}viewDialog(r){this.dialogService.open(r)}search(r){r?(this.searchModel.PageNumber=r.pageIndex+1,this.searchModel.PageSize=r.pageSize):(this.searchModel.PageNumber=1,this.searchModel.PageSize=10),this.userService.searchUsers(this.searchModel).subscribe(o=>{this.user=o.entity.entities,this.totalRecords=o.entity.totalRecords,this._detector.markForCheck(),this.dataSource=new c.I6(this.user)})}onToggleChange(r,o){console.log(r.id),this.userId=r.id,r.isActive?(r.isActive=!1,this.userService.ActivateUser(r.id).subscribe(n=>{this.toastr.Activate(g.C.User),this.search()})):(r.isActive=!0,this.userService.DeActivateUser(r.id).subscribe(n=>{this.toastr.Deactivate(g.C.User),this.search()}))}delete(r,o){var n=this;return(0,$.A)(function*(){o=yield n.translate.get(o).toPromise();let i=yield n.translate.get("DeleteTitle",{entity:o}).toPromise(),l=yield n.translate.get("DeleteMessage",{entity:o}).toPromise();n.dialogService.open(Ie.w,{context:{title:`${i}`,body:`${l}?`},closeOnBackdropClick:!1}).onClose.subscribe(u=>{u&&n.userService.deleteUser(r).subscribe(I=>{n.user=n.user.filter(E=>E.id!=r),n.search(),n.toastrService.Delete(g.C.User)})})})()}ShowAdd(){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Users/add")}ShowMap(){window.open("https://www.google.com/","_blank")}ShowMap1(){window.open("https://www.arcgis.com/apps/mapviewer/index.html?url=https://geodatastore.jeddah.gov.sa/maps/rest/services/Grants/GrantsParcels/MapServer&source=sd")}ShowEdit(r){this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/Users/edit/"+r)}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(C.t),e.rXU(h.c$),e.rXU(N),e.rXU(f.Ix),e.rXU(f.nX),e.rXU(e.gRc),e.rXU(m.S0W),e.rXU(C.t),e.rXU(v.W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-list-users"]],viewQuery:function(o,n){if(1&o&&(e.GBs(F.B4,5),e.GBs(S.iy,5),e.GBs(Fe,5),e.GBs(Ce,5),e.GBs(Ue,5)),2&o){let i;e.mGM(i=e.lsd())&&(n.sort=i.first),e.mGM(i=e.lsd())&&(n.paginator=i.first),e.mGM(i=e.lsd())&&(n.nameFilter=i.first),e.mGM(i=e.lsd())&&(n.emailFilter=i.first),e.mGM(i=e.lsd())&&(n.roleFilter=i.first)}},decls:43,vars:15,consts:[[1,"content-container"],["type","button",1,"special-button","mb-3",3,"hidden","click"],[1,"table-container"],["mat-table","","matSort","","matSortDisableClear","","matSortDirection","asc",1,"users-table","table-striped",3,"dataSource","matSortChange"],["matColumnDef","Name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Role"],["matColumnDef","NationalId"],["matColumnDef","Phone"],["matColumnDef","Mobil"],["matColumnDef","Email"],["matColumnDef","Activate"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","DeActivate"],["matColumnDef","actions"],["matColumnDef","actions1"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"dir","length","pageIndex","pageSize","pageSizeOptions","page"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf","ngIfElse"],["data",""],["type","text","nbInput","","matInput","",1,"text-center",3,"placeholder","keyup"],["nameFilter",""],["roleFilter",""],["mat-header-cell",""],[3,"ngModel","ngModelChange","change"],["nbButton","","type","button","status","primary","nbButton","",1,"submitBtn",3,"click"],["mat-mini-fab","","color","primary",3,"hidden","click"],["mat-mini-fab","","color","warn",3,"hidden","click"],["mat-header-row",""],["mat-row",""]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"h2"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.nrm(4,"hr"),e.j41(5,"button",1),e.bIt("click",function(){return n.ShowAdd()}),e.EFF(6),e.nI1(7,"translate"),e.k0s(),e.j41(8,"nb-card",2)(9,"table",3),e.bIt("matSortChange",function(l){return n.sortData(l)}),e.qex(10,4),e.DNE(11,Se,3,3,"th",5),e.DNE(12,Re,4,2,"td",6),e.bVm(),e.qex(13,7),e.DNE(14,Te,3,3,"th",5),e.DNE(15,ye,4,2,"td",6),e.bVm(),e.qex(16,8),e.DNE(17,je,3,3,"th",5),e.DNE(18,De,4,2,"td",6),e.bVm(),e.qex(19,9),e.DNE(20,we,3,3,"th",5),e.DNE(21,Pe,4,2,"td",6),e.bVm(),e.qex(22,10),e.DNE(23,Ae,3,3,"th",5),e.DNE(24,Xe,4,2,"td",6),e.bVm(),e.qex(25,11),e.DNE(26,Oe,3,3,"th",5),e.DNE(27,ze,4,2,"td",6),e.bVm(),e.qex(28,12),e.DNE(29,qe,3,3,"th",13),e.DNE(30,He,5,2,"td",6),e.bVm(),e.qex(31,14),e.DNE(32,Ze,3,3,"th",13),e.DNE(33,Qe,4,3,"td",6),e.bVm(),e.qex(34,15),e.DNE(35,et,1,0,"th",13),e.DNE(36,rt,4,2,"td",6),e.bVm(),e.qex(37,16),e.DNE(38,ot,1,0,"th",13),e.DNE(39,it,4,2,"td",6),e.bVm(),e.DNE(40,lt,1,0,"tr",17),e.DNE(41,mt,1,0,"tr",18),e.k0s()(),e.j41(42,"mat-paginator",19),e.bIt("page",function(l){return n.search(l)}),e.k0s()()),2&o&&(e.R7$(2),e.SpI(" ",e.bMT(3,11,"Users")," "),e.R7$(3),e.Y8G("hidden",!n.canAdd),e.R7$(1),e.SpI(" ",e.bMT(7,13,"Add")," "),e.R7$(3),e.Y8G("dataSource",n.dataSource),e.R7$(31),e.Y8G("matHeaderRowDef",n.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",n.displayedColumns),e.R7$(1),e.Y8G("dir",n.dir)("length",n.totalRecords)("pageIndex",n.searchModel.PageNumber-1)("pageSize",n.searchModel.PageSize)("pageSizeOptions",n.pageSizeOptions))},dependencies:[m.SrT,m.YP2,m.i6h,b.bT,a.BC,a.vS,T.An,Ee.ig,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,F.B4,F.aE,S.iy,m.YF2,h.D9],styles:[".table-container[_ngcontent-%COMP%]{border-radius:2rem;overflow-x:scroll;overflow-y:auto}table[_ngcontent-%COMP%]{width:20rem}.search-container[_ngcontent-%COMP%]{margin:1rem auto;display:flex;justify-content:center}.col-md-4[_ngcontent-%COMP%], .col-md-6[_ngcontent-%COMP%], .col-md-12[_ngcontent-%COMP%]{padding:5px!important}.users-table[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;border-collapse:collapse}tr[_ngcontent-%COMP%]{height:3.2rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center!important;padding:10px}th[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1.3rem}  .mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0;justify-content:center}"]})}}return t})()},{path:"add",component:se},{path:"edit/:id",component:ge}];let pt=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[f.iI.forChild(dt),f.iI]})}}return t})(),ct=(()=>{class t{constructor(r){this.ref=r,this.confirmStatus="danger",this.closeStatus="basic"}dismiss(){this.ref.close()}confirm(){this.ref.close(!0)}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(m.ybQ))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-confirmation-dialog"]],inputs:{title:"title",body:"body",buttonText:"buttonText",confirmStatus:"confirmStatus",closeStatus:"closeStatus"},decls:4,vars:0,consts:[["nbButton","",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"button",0),e.bIt("click",function(){return n.confirm()}),e.EFF(1,"ds"),e.k0s(),e.j41(2,"button",0),e.bIt("click",function(){return n.dismiss()}),e.EFF(3,"dd"),e.k0s())},styles:["nb-card[_ngcontent-%COMP%]{max-width:600px;max-height:500px}"]})}}return t})();var ut=d(1799);let ht=(()=>{class t{constructor(r){this.modalService=r}confirm(r,o,n="OK",i="Cancel",l="sm"){const u=this.modalService.open(ct,{size:l});return u.componentInstance.title=r,u.componentInstance.message=o,u.componentInstance.btnOkText=n,u.componentInstance.btnCancelText=i,u.result}static{this.\u0275fac=function(o){return new(o||t)(e.KVO(ut.Bq))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ft=d(3922);let _t=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({providers:[m.S0W,ht],imports:[pt,m.lVF,m.P5N,m.pty,b.MD,a.YN,a.X1,m.dQU,m.lVF,m.P5N,m._A2,m.NeG,m.clu,m.VcP,T.m_,c.tP,F.NQ,S.Ou,m.jVr,ft.G,h.h.forChild({loader:{provide:h.Wr,useFactory:y._,deps:[U.Qq]}})]})}}return t})()}}]);